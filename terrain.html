<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="cache-control" content="no-cache" />
  <link rel="icon" href="finance.ico" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="-1" />
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="viewport"
  content="
    height = 1000px,
    width = 1000px,
    initial-scale = 0.6,
    minimum-scale = 0.6,
    maximum-scale = 0.6,
    user-scalable = no,
    target-densitydpi = device-dpi
    " />
  <title></title>
  <link rel="stylesheet" href="node_modules/materialize-css/dist/css/materialize.min.css">
  <link href="static/css/main.css" rel="stylesheet">
  <link href="static/css/loading.css" rel="stylesheet">
  <link rel="stylesheet" href="static/font-awesome-4.7.0/css/font-awesome.min.css">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/webrtc-adapter/3.3.3/adapter.min.js"></script>
  <script src="node_modules/jquery/dist/jquery.min.js" type="text/javascript">
  </script>
  <script src="node_modules/sweetalert/dist/sweetalert.min.js" type="text/javascript"></script>
  <script type="text/javascript" src="modules/main.js"></script>
</head>

<body  onload="start_loading();printProducts()">

  <div id="loading" class="lds-css ng-scope"><div style="width:100%;height:100%" class="lds-double-ring"><div></div><div></div><div></div><div></div></div></div>


  <div id="modal2" class="modal">
    <div class="modal-content" id="modal2_content">
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">D'accord</a>
    </div>
  </div>

  <nav id="nav_principal">
    <div id="name_lastName" class="nav-wrapper z-depth-5">
      <ul class="left ">
        <li><a href="index.html"><i class="fa fa-arrow-left fa-3x right"></i></a></li>
      </ul>
    </div>
  </nav>

  <div id="loading_section">
  <div class="row">
    <div class="col s12 m4 hoverable">
      <!--Container VENTE -->
      <div class="card  cyan darken-4">
        <div class="card-content white-text">
          <span class="card-title center "><h3>ARTICLES</h3></span>
          <div class="center">
            <div id="products" class="row">
            </div>
          </div>
        </div>
      </div>
    </div>



    <div class="col s12 m4 hoverable" >
      <!--Container LIST-->
      <div class="card teal darken-4 center" >
        <div class="card-content white-text row" id="container_list">
          <span class="card-title center" id="container_list1"><h3>À PAYER</h3></span>
          <div id="list_vide">
            <h4>VIDE</h4>
          </div>
          <div id="list" class "">
            <!-- LISTE DES ARTICLES A LIST -->
          </div>
          <span class="card-title center col s12 " id="container_list2"></span>
          <div class="collection col s12" id="container_list3">
            <a class="collection-item teal-text darken-4 bold-text"><h5 class="left">Total</h5><h5 id="totalList"class="right-align">0  CHF</h5></a>
          </div>
        </div>
      </div>
    </div>

    <div class="col s12 m4 hoverable">
      <!--Container PAYMENT-->
      <div class="card lime darken-4 center" >
        <div class="card-content white-text row" id="container_payment">
          <span class="card-title center" id="PAYMENT"><h3>PAYMENT</h3></span>
          <div id="payment_vide">
            <h4>VIDE</h4>
          </div>
          <div id="topay" class="row">
            <!-- LISTE DES ARTICLES A PAYER -->
          </div>
          <span class="card-title center row col s12" id="PAYMENT_INFO"></span>
          <div class="collection col s12" id="payments_total">
            <a class="collection-item teal-text darken-5 bold-text disapear" id="total_a_payer"><h5 class="left">Total à payer</h5><h5 id="totalPay"class="right-align">0 CHF</h5></a>
            <a class="collection-item teal-text darken-5 bold-text" onclick="$('#modal_products_payed').modal('open')" href="#modal_products_payed"><h5 class="left">Payé</h5><h5 id="totalPayed"class="right-align">0  CHF</h5></a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="modal_products_payed" class="modal">
  <div class="modal-content center" id="modal_products_payed_content">
    <h4>PAYMENTS RÉALISÉS</h4>
    <table>
      <tr>
        <th>ARTICLES</th>
        <th>ICON</th>
        <th>QUANTITÉ</th>
        <th>PAYMENT</th>
        <th style="text-align: right">PRIX (CHF)</  th>
        <th style="text-align: right">TOTAL (CHF)</th>
        <th style="text-align: center">SUPRIMER</th>
      </tr>
      <tbody id="tbody_products_payed">
      </tbody>
      <tbody>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th style="text-align: right">TOTAL</th>
          <th style="text-align: right" id="table_total_payed"></th>
          <th></th>
        </tr>
      </tbody>

    </table>
  </div>
  <div class="modal-footer">
    <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">OK</a>
  </div>
</div>


<div id="modal_pay_cash" class="modal">
<div class="modal-content center" id="">
  <table>
    <tr>
      <td style="text-align: center;"><h4>Total <span id="modal_cash_total"> 0 </span> CHF </h4></td>
      <td style="text-align: center;"><h4>Total à payer: <span id="modal_cash_total_to_pay"> 0 </span> CHF </h4></td>
      <td style="text-align: center;"><h4>Retour : <span id="modal_cash_change"> 0 </span> CHF </h4></td>
    </tr>
  </table>
  <table id= "table_money">

    <tr>
      <td style="text-align: center;" id="10fr"><p id="10fr_quantity"> 0 </p><img src="static/money/10fr.jpeg"   height="120" width="185"></td>
      <td style="text-align: center;" id="20fr"><p id="20fr_quantity"> 0 </p><img src="static/money/20fr.jpg"   height="120" width="195"></td>
      <td style="text-align: center;" id="50fr"><p id="50fr_quantity" >  0 </p><img src="static/money/50fr.jpg"   height="120" width="205"></td>
      <td style="text-align: center;" id="100fr"><p id="100fr_quantity" >  0 </p><img src="static/money/100fr.jpeg"   height="120" width="215"></td>
    </tr>
    <tr>
      <td style="text-align: center;" id="200fr"><p id="200fr_quantity" >  0 </p><img src="static/money/200fr.jpeg"   height="120" width="225"></td>
      <td style="text-align: center;" id="1000fr"><p id="1000fr_quantity" > 0 </p><img src="static/money/1000fr.jpg"  height="120" width="235" ></td>
      <td style="text-align: center;" id="0_05fr"><p id="0_05fr_quantity" >  0 </p><img src="static/money/0.05.png"   height="120" width="120"></td>
      <td style="text-align: center;" id="0_1fr"><p id="0_1fr_quantity" >  0 </p><img src="static/money/0.10fr.png"   height="120" width="120"></td>
    </tr>

    <tr>

      <td style="text-align: center;" id="0_2fr"><p id="0_2fr_quantity" >  0 </p><img src="static/money/0.20.png"   height="120" width="120"></td>
      <td style="text-align: center;" id="0_5fr"><p id="0_5fr_quantity" >  0 </p><img src="static/money/0.5fr.png"   height="120" width="120"></td>
      <td style="text-align: center;" id="1fr"><p id="1fr_quantity" >  0 </p><img src="static/money/1fr.png"   height="125" width="125"></td>
      <td style="text-align: center;" id="2fr"><p id="2fr_quantity" > 0 </p><img src="static/money/2fr.png"   height="125" width="125"></td>
    </tr>
      <tr>
      <td style="text-align: center;" id="5fr"><p id="5fr_quantity" >  0 </p><img src="static/money/5fr.png"   height="125" width="125"></a></td>
      <td style="text-align: center;"><a onclick="clean_money();" class="waves-effect waves-light btn-large orange" style="height: 8em; width: 16em;" ><i class="fa fa-refresh	fa-4x" style="font-size: 7rem; margin-top: 2rem;" aria-hidden="true"></i></a></td>
      <td style="text-align: center;"><a onclick="clean_money(); $('#modal_pay_cash').modal('close');" class="waves-effect waves-light btn-large red" style="height: 8em; width: 16em;" ><i class="fa fa-close	fa-5x" style="font-size: 8rem; margin-top: 2rem;" aria-hidden="true"></i></a></td>
      <td  style="text-align: center;"><a onclick="pay_cash_modal();" class="waves-effect waves-light btn-large" style="height: 8em; width: 16em;" ><i class="fa fa-check fa-5x" style="font-size: 8rem; margin-top: 2rem;" aria-hidden="true"></i></a></td>
      </tr>

  </table>

</div>
</div>
</div>




  <div class="fixed-action-btn toolbar">
    <a class="btn-floating btn-large red darken-4">
        <i class="fa fa-shopping-cart fa-5x" aria-hidden="true"></i>
      </a>
    <ul>
      <li class="waves-effect waves-light" onclick="close_Cash_register();"><a <i class="fa fa-shopping-cart fa-5x" aria-hidden="true"></i></a></li>
      <li class="waves-effect waves-light lime darken-4"><a class="modal-trigger btn " id="bottom_list_payment" href="#modal_products_payed"><i style="font-size: 5em;"class="fa fa-bars" aria-hidden="true"></i></a></li>
      <li class="waves-effect waves-light lime darken-4" onclick="click_pay_cash()" ><a  id="bottom_payment_cash"><i class="fa fa-money fa-5x" aria-hidden="true"></i></a></li>
      <li class="waves-effect waves-light lime darken-4" onclick="click_pay_carte()" ><a href="#!" id="bottom_payment_card"><i class="fa fa-credit-card fa-5x" aria-hidden="true"></i></a></li>
    </ul>
  </div>



  <script src="node_modules/materialize-css/dist/js/materialize.min.js" type="text/javascript"></script>
  <script>
    $(document).ready(function() {
      $('.tabs').tabs({
        swipeable: true
      });
    });
  </script>
  <script>
    $(".button-collapse").sideNav();
  </script>

  <script type="text/javascript">

    $(document).ready(function() {
      $('.modal').modal();
      clickLocation();
      stop_loading();
    });
  </script>

  <script type="text/javascript">

  function calculate_money (img_id, money_quantity_id, number) {
    $( img_id ).on( "click", function() {
      $(money_quantity_id).html(Number($( money_quantity_id ).text()) + 1);
      $("#modal_cash_total").html((Number($( "#modal_cash_total" ).text()) + number).toFixed(2));
      if ((Number($("#modal_cash_total").text())) > (Number($("#modal_cash_total_to_pay").text()))) {
        $("#modal_cash_change").html(((Number($( "#modal_cash_total" ).text())) - (Number($( "#modal_cash_total_to_pay" ).text()))).toFixed(2));
      }
      else {
        $("#modal_cash_change").html(0);
      }

    });
    $( img_id ).on('touchstart', function (e) {
        if (e.touches.length == 2 && ((Number($( money_quantity_id ).text()))- 1) >= 0 ){
        $(money_quantity_id).html(Number($( money_quantity_id ).text()) - 1);
        $("#modal_cash_total").html((Number($( "#modal_cash_total" ).text()) - number).toFixed(2));
        if ((Number($("#modal_cash_total").text())) > (Number($("#modal_cash_total_to_pay").text()))) {
          $("#modal_cash_change").html((Number($( "#modal_cash_total" ).text())) - (Number($( "#modal_cash_total_to_pay" ).text())));
        }
        else {
          $("#modal_cash_change").html(0);
        }
        }
    });
  }
  let money_array = [0.05, 0.10 , 0.20, 0.50, 1, 2, 5, 10, 20, 50, 100, 200, 1000];
  money_array.forEach(function(money){
    if (String(money).includes(".")){
      let money_ = String(money).replace(".", "_");
      calculate_money("#"+money_+"fr", "#"+money_+"fr_quantity", money);
    }
    else{
      calculate_money("#"+money+"fr", "#"+money+"fr_quantity", money);
    }
  });

  function clean_money(){
      money_array.forEach(function(money){
        if (String(money).includes(".")){
          let money_ = String(money).replace(".", "_");
          $("#"+money_+"fr_quantity").html(0);
        }
        else{
          $("#"+money+"fr_quantity").html(0);
        }
      });
      $("#modal_cash_total").html(0);
      $("#modal_cash_change").html(0);


  }

  function pay_cash_modal(){
    if ((Number($("#modal_cash_total").text())) >= (Number($( "#modal_cash_total_to_pay" ).text()))){
    swal({
        title: "Payment en CASH",
        text: $("#totalPay").text(),
        icon: "warning",
        buttons: true,
        dangerMode: false,
      })
      .then((willDelete) => {
        if (willDelete) {
          start_loading();
          pay_cash();
          swal("C'est fait", {
              icon: "success",
              timer: 650,
              buttons: false,
            })
            .then((value) => {
              actualize();
              $("#modal_pay_cash").modal('close');

            });
        } else {
          swal("Vous n'avez rien encaissé!", {
            timer: 700,
            buttons: false,
          });
        }
      });
    }
    else{
      swal("L'argent reçu est insuffisant", {
        timer: 700,
        buttons: false,
      });
    }
  }

  </script>
</body>

</html>
